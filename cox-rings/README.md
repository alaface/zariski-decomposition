# Zariski Decomposition from Cox Rings

This directory provides a Magma implementation of the **Zariski decomposition** of a divisor class on a variety with finitely generated Cox ring, based on the degrees of the generators.

## Contents

- `library.m` — Core library implementing the decomposition algorithm based on the Cox ring.

## Description

Let $X$ be a projective variety whose Cox ring is finitely generated by homogeneous elements $f_1, \dots, f_r$, with degrees $w_1, \dots, w_r \in {\rm Cl}(X)$.  
Given a divisor class $w_D \in {\rm Cl}(X)$, the **Zariski decomposition** expresses it as:

$w_D = w_P + w_N$

where:
- $w_P$ is the class of a nef divisor,
- $w_N = \sum \mu_i w_i$ is the class of an effective combination of the generators,
- and $\mu_i \in \mathbb{Q}_{\ge 0}$.

## Reference

This algorithm is based on **Theorem 3.3.4.8** of the following book:

**Ivan Arzhantsev, Ulrich Derenthal, Jürgen Hausen, Antonio Laface**,  
*Cox Rings*, Cambridge Studies in Advanced Mathematics, Vol. 144,  
Cambridge University Press, 2015. MR3307753.

## How it Works

For each $i \in \{1, \dots, r\}$:

1. Construct the cone:

   $\tau_i := {\rm cone}(w_D, -w_i) \cap {\rm cone}(w_j : j \ne i)$

2. For each extremal ray $R$ of $\tau_i$, solve the linear system:

   $w_D = x \cdot w_i + y \cdot R$

3. Take the **minimum non-negative value of $x$** over all solutions, and set $\mu_i := \min(x \ge 0)$.

4. Set $w_N := \sum \mu_i w_i$, and $w_P := w_D - w_N$.

## How to Use

1. Load the library:

```magma
load "library.m";

L := ToricLattice(2);
W := [ L![1,0], L![0,1], L![0,1], L![1,3] ];
wD := L![2,5];

wP, wN, mu := ZariskiDecomposition(wD, W);

print "Positive part P =", wP;
print "Negative part N =", wN;
print "Vector of coefficients mu =", mu;
